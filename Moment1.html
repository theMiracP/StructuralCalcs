<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Moment Hesabı - XP</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="kutu">
  <div class="baslik">
    <span>Kiriş Moment Hesabı (Tekil Yük)</span>
    <button class="kapat" onclick="window.location.href='index.html'">X</button>
  </div>

  <div class="icerik">
    
    <label>Yük Değeri, P (kN):</label>
    <input type="number" id="yuk" placeholder="Örn: 10">

    <label>Kiriş Uzunluğu, L (m):</label>
    <input type="number" id="uzunluk" placeholder="Örn: 5">

    <label>Yükün Sol Desteğe Uzaklığı, a (m):</label>
    <input type="number" id="yukKonum" placeholder="Örn: 2.5">

    <button class="xp-buton" onclick="hesapla()">Hesapla ve Çiz</button>

    <div id="sonuc" style="margin-top:10px; font-weight:bold; color:red; height:20px;"></div>

    <canvas id="kirisCanvas" width="380" height="180" style="background:#fff; border:1px solid #7F9DB9; margin-top:10px; display:block;">
      Tarayıcınız bu grafiği desteklemiyor.
    </canvas>

  </div>
</div>
<script>
function hesapla() {
  // --- ADIM 1: Verileri Al ---
  // HTML kutularından değerleri çekip sayıya (parseFloat) çeviriyoruz.
  const L = parseFloat(document.getElementById("uzunluk").value);
  const P = parseFloat(document.getElementById("yuk").value);
  const a = parseFloat(document.getElementById("yukKonum").value);

  // Hata kontrolü: Değerler boş mu veya mantıksız mı?
  if (isNaN(L) || isNaN(P) || isNaN(a) || L <= 0) {
    document.getElementById("sonuc").innerText = "Lütfen geçerli sayısal değerler giriniz!";
    return;
  }
  if (a > L) {
    document.getElementById("sonuc").innerText = "Hata: Yük konumu kirişten uzun olamaz!";
    return;
  }

  // --- ADIM 2: Hesaplama (Basit Kiriş Üzerinde Tekil Yük) ---
  // Formül: M_max = (P * a * b) / L
  // a: soldan mesafe, b: sağdan mesafe
  const b = L - a;
  const momentMax = (P * a * b) / L;

  // Sonucu ekrana yaz (virgülden sonra 2 basamak)
  document.getElementById("sonuc").innerText = "Maksimum Moment = " + momentMax.toFixed(2) + " kNm";
  document.getElementById("sonuc").style.color = "#000080";

  // --- ADIM 3: Çizim (Canvas) ---
  const canvas = document.getElementById("kirisCanvas");
  const ctx = canvas.getContext("2d");

  // 3.1. Tuvali Temizle (Eski çizimi silmek için çok önemli)
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // 3.2. Koordinat Ayarları
  // Grafiği canvasın ortasına oturtmak için kenar boşlukları (margin)
  const marginX = 40; 
  const marginY = 30;
  const drawWidth = canvas.width - 2 * marginX; // Çizilebilir genişlik
  const drawHeight = 100; // Grafik yüksekliği

  // Ölçekleme (Metreyi Piksele çevirme)
  // Kirişin tamamı (L) -> drawWidth kadar piksele sığmalı
  const scaleX = drawWidth / L;
  
  // Moment değerini yüksekliğe sığdırma
  // Eğer moment 0 ise hatayı önlemek için 1 kabul et
  const maxM_for_scale = momentMax === 0 ? 1 : momentMax;
  const scaleY = drawHeight / maxM_for_scale;

  // Başlangıç noktası (Sol alt köşe referansı)
  // Y ekseninde: 140. piksel referans olsun (aşağıdan yukarı çizeceğiz)
  const zeroY = 140; 
  const zeroX = marginX;

  // --- 3.3. Eksenleri ve Kirişi Çiz ---
  ctx.beginPath();
  ctx.strokeStyle = "#888";
  ctx.lineWidth = 4;
  ctx.moveTo(zeroX, zeroY); // Sol destek
  ctx.lineTo(zeroX + L * scaleX, zeroY); // Sağ desteğe kadar çizgi
  ctx.stroke();

  // Destekleri (Üçgen) Çiz (Görsellik için)
  drawSupport(ctx, zeroX, zeroY + 2); // Sol
  drawSupport(ctx, zeroX + L * scaleX, zeroY + 2); // Sağ

  // --- 3.4. Moment Diyagramını Çiz (Mavi Çizgi) ---
  // 3 nokta var: Başlangıç (0,0), Tepe (a, Mmax), Bitiş (L,0)
  
  const peakX = zeroX + (a * scaleX);       // Tepe noktasının X pikseli
  const peakY = zeroY - (momentMax * scaleY); // Tepe noktasının Y pikseli (yukarı gitmek için çıkarıyoruz)

  ctx.beginPath();
  ctx.moveTo(zeroX, zeroY); // 0 noktasından başla
  ctx.lineTo(peakX, peakY); // Tepeye git
  ctx.lineTo(zeroX + L * scaleX, zeroY); // Bitişe git
  ctx.strokeStyle = "blue";
  ctx.lineWidth = 2;
  ctx.stroke();

  // --- 3.5. Alanı Boya (Opsiyonel: Şeffaf mavi) ---
  ctx.fillStyle = "rgba(0, 0, 255, 0.1)";
  ctx.fill();

  // --- 3.6. Değerleri Yaz ---
  ctx.fillStyle = "black";
  ctx.font = "12px Tahoma";
  
  // Tepe noktasına değeri yaz
  ctx.fillText(momentMax.toFixed(1) + " kNm", peakX - 20, peakY - 10);
  
  // Yükün konumunu gösteren kırmızı bir ok çiz
  drawArrow(ctx, peakX, zeroY - 2, peakX, zeroY - 20); // Yükü göstermek için
  ctx.fillStyle = "red";
  ctx.fillText("P=" + P, peakX - 10, zeroY - 25);
}

// Yardımcı Fonksiyon: Destek Üçgeni Çizimi
function drawSupport(ctx, x, y) {
    ctx.fillStyle = "#555";
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x - 5, y + 10);
    ctx.lineTo(x + 5, y + 10);
    ctx.fill();
}

// Yardımcı Fonksiyon: Yük Oku Çizimi
function drawArrow(ctx, fromx, fromy, tox, toy) {
    // Burada basitlik olsun diye yukarıdan aşağı sadece P harfini yazdık, 
    // ama istenirse buraya ok çizim kodları eklenebilir.
}
</script>

</body>
</html>